<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ì¼ë°˜íšŒì› ê°€ì… í˜ì´ì§€</title>
<th:block th:replace="~{fragments/external_file :: cdn_block}"></th:block>
<link rel="stylesheet" th:href="@{/login/joinUserForm.css}">
<style>
    
</style>
<script type="text/javascript">
$(function(){
	
	//ëª¨ë‹¬ ê³¨ë¼ ë³´ê¸° í˜¸ì¶œ
	showTheModal(); 
	
	// ì „ì²´ ë™ì˜ ì²´í¬ë°•ìŠ¤ ê¸°ëŠ¥
	document.getElementById('terms1').addEventListener('change', function() {
	    const checkboxes = document.querySelectorAll('.checkbox-input:not(#terms1)');
	    checkboxes.forEach(checkbox => {
	        checkbox.checked = this.checked;
	    });
	});
	
	// ê°œë³„ ì²´í¬ë°•ìŠ¤ ë³€ê²½ ì‹œ ì „ì²´ ë™ì˜ ìƒíƒœ ì—…ë°ì´íŠ¸
	document.querySelectorAll('.checkbox-input:not(#terms1)').forEach(checkbox => {
	    checkbox.addEventListener('change', function() {
	        const allCheckboxes = document.querySelectorAll('.checkbox-input:not(#terms1)');
	        const checkedBoxes = document.querySelectorAll('.checkbox-input:not(#terms1):checked');
	        document.getElementById('terms1').checked = allCheckboxes.length === checkedBoxes.length;
	    });
	});
	
	// í¼ ì œì¶œ ì²˜ë¦¬
	document.querySelector('form').addEventListener('submit', function(e) {
	    e.preventDefault();
	    //ì˜ˆì™¸ì²˜ë¦¬ ê²€ì‚¬ í•¨ìˆ˜ í˜¸ì¶œ
	    if(validateForm()){
		    alert('íšŒì›ê°€ì… ì–‘ì‹ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
		    //this.submit();
	    }
	    
	});
	
	//í¼ ì˜ˆì™¸ì²˜ë¦¬ ê²€ì‚¬
	function validateForm(){
		let flag = true;

		
		//ì•½ê´€ - í•„ìˆ˜ í•­ëª© ì²´í¬ ì—¬ë¶€ í™•ì¸
		let termFlag = true;
		document.querySelectorAll('.checkbox-input.required').forEach(checkbox => {
			if(!checkbox.checked){
				termFlag = false;
			}
		});
		if(!termFlag){
			alert('í•„ìˆ˜ ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
			flag = false;			
		}
		
		
		
		return flag;
	}//validateForm()
	
	
	//ì¸ì¦ë²ˆí˜¸ ì²˜ë¦¬, ì¸ì¦ìš”ì²­ ë²„íŠ¼ì„ í´ë¦­ì‹œ (180ì´ˆí•˜ì)
	document.getElementById('codeBtn').addEventListener('click', function(){
		alert("ë””ë²„ê¹…ëª¨ë“œë¡œ 5ì´ˆë§Œ ìœ ì§€í•©ë‹ˆë‹¤.");
		//ì¸ì¦ë²ˆí˜¸ ì…ë ¥ì¹¸& í™•ì¸ë²„íŠ¼ í‘œì‹œ
		document.getElementById('confirmNumberFrm').style.display='block';
		//displayë¥¼ none â†’ blockìœ¼ë¡œ ë°”ê¾¸ë©´ ê¸°ì¡´ flex ì†ì„±ì€ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ ë‹¤ì‹œ ì„¤ì •í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.
		document.getElementById('confirmNumberFrm').style.display='flex';
		//í™•ì¸ë²„íŠ¼ì€ 6ê°œ ìˆ«ìì¼ ê²½ìš°ì—ë§Œ ê°ì§€í•˜ì—¬ í™•ì¸ë²„íŠ¼ì„ í™œì„±í™” 
		document.getElementById('confirmNumber').addEventListener('input', function(e){
			let length = this.value.length;
			const btn = document.getElementById('confirmBtn');
			if(length == 6){
				btn.disabled = false;
			} else {
				btn.disabled = true;
			}
		})
		//ë³´ëƒˆìœ¼ë¯€ë¡œ ì¸ì¦ìš”ì²­ ë²„íŠ¼ì˜ í…ìŠ¤íŠ¸ë¥¼ ì¬ì „ì†¡ìœ¼ë¡œ ë³€ê²½
		document.getElementById('codeBtn').textContent='ì¬ì „ì†¡'; 
		//íƒ€ì´ë¨¸ ì‹œì‘
		startTimer(5, $("#timer"));
		document.getElementById('remainTime').style.display='block'; //ë‚¨ì€ ì¸ì¦ì‹œê°„ í‘œì‹œ, ë§Œë£Œì‹œ ìˆ¨ê¹€ìœ¼ë¡œ í•´ë†¨ìœ¼ë¯€ë¡œ ì¬ì „ì†¡ì‹œ í•„ìš”
		document.getElementById('verification-error').style.display='none';  //ì¸ì¦ì‹œê°„ ë§Œë£Œ í‘œì‹œ ìˆ¨ê¹€, ì¬ì „ì†¡ì‹œ í•„ìš”
		//
		
	});
	
	

	//ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ í™•ì¸ë²„íŠ¼ì— ì´ë²¤íŠ¸ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (ì°¸ì¡°ë§Œ ë„˜ê¸°ëŠ”ê±°ì— ì£¼ì˜, ..() x)
	document.getElementById('confirmBtn').addEventListener('click', checkConfirmNumber); 
	
}); //ready


//í™•ì¸ë²„íŠ¼ ì´ë²¤íŠ¸ë¦¬ìŠ¤ë„ˆì— ë“±ë¡ë  ì¸ì¦ë²ˆí˜¸í™•ì¸ í•¨ìˆ˜
function checkConfirmNumber(){
	//í™•ì¸ë²„íŠ¼ í´ë¦­ì‹œ ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•Šì„ ë•Œ (ì˜ˆì‹œë¡œ 123456ìœ¼ë¡œ í•´ë†¨ìŒ. ìˆ˜ì •í•˜ì~)
	if(document.getElementById('confirmNumber').value != 123456){
		document.getElementById('remainTime').style.display='none'; //ë‚¨ì€ ì¸ì¦ì‹œê°„ ìˆ¨ê¸°ê³ ,
		document.getElementById('verification-error').textContent='ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.'  //ì—ëŸ¬ í…ìŠ¤íŠ¸ ìˆ˜ì •í•˜ê³ ,
		document.getElementById('verification-error').style.display='block';  //ì—ëŸ¬ í…ìŠ¤íŠ¸ í‘œì‹œ
	} else {
		//ì¸ì¦ì— ì„±ê³µí•  ë•Œ
		alert('ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.');
		//íƒ€ì´ë¨¸ì¢…ë£Œ
		clearInterval(timerInterval);
		
		document.getElementById('remainTime').style.display='none'; //ë‚¨ì€ ì¸ì¦ì‹œê°„ ìˆ¨ê¸°ê³ ,
		document.getElementById('verification-success').style.display='block';  //ì„±ê³µ í…ìŠ¤íŠ¸ í‘œì‹œ
		document.getElementById('confirmBtn').disabled = true; //ë§ìœ¼ë‹ˆê¹Œ ì´ì œ í™•ì¸ë²„íŠ¼ ë§‰ì•„
		document.getElementById('codeBtn').disabled = true; //ë§ìœ¼ë‹ˆê¹Œ ì´ì œ ì¬ì „ì†¡ë²„íŠ¼ë„ ë§‰ì•„
		document.getElementById('confirmNumber').readOnly = true; //ë²ˆí˜¸ì…ë ¥ì°½ë„ ë§‰ì•„
		
		document.getElementById('verification-error').style.display = 'none'; //í˜¹ì‹œë‚˜í•´ì„œ 
		
		return;
	}
}

// ëª¨ë‹¬ì°½ ê³¨ë¼ ì—´ê¸° 
function showTheModal(){
	// ì•½ê´€ ë²„íŠ¼ í´ë¦­ ì‹œ ì§ì ‘ ëª¨ë‹¬ ë‚´ìš© ë³€ê²½
	document.querySelectorAll('.term-btn').forEach(btn => {
		btn.addEventListener('click', function(e){
			// í´ë¦­ëœ ë²„íŠ¼ì˜ data-term ì†ì„± ê°€ì ¸ì˜¤ê¸°
			const selectedTerm = this.getAttribute('data-term');
			//console.log('ì„ íƒëœ ì•½ê´€:', selectedTerm);
			
			//ëª¨ë“  term fragmentë¥¼ ìˆ¨ê¸°ê¸° 			
			document.querySelectorAll('.term-fragment').forEach(div => {
				div.style.display = 'none';
			});
			
			//ì„ íƒí•˜ í•­ëª©ë§Œ í‘œì‹œ
			const target = document.getElementById(selectedTerm);
			if(target){
				target.style.display = 'block';
			}
			
		});
	});
} //showTheModal()


//------- íƒ€ì´ë¨¸ í•¨ìˆ˜ ---------
let timerInterval; // ğŸ”¸ ì „ì—­ìœ¼ë¡œ ì„ ì–¸í•´ì•¼ ê¸°ì¡´ íƒ€ì´ë¨¸ clear ê°€ëŠ¥

function startTimer(duration, display) {
    let timer = duration;
    let minutes, seconds;
    
    // ê¸°ì¡´ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ ì •ë¦¬
    clearInterval(timerInterval);
    
    timerInterval = setInterval(function() {
        minutes = parseInt(timer / 60, 10);
        seconds = parseInt(timer % 60, 10);
        
        minutes = minutes < 10 ? "0" + minutes : minutes;
        seconds = seconds < 10 ? "0" + seconds : seconds;
        
        display.text(minutes + ":" + seconds);
        
        //ì¸ì¦ì‹œê°„ ë§Œë£Œì‹œ
        if (--timer < 0) {
            clearInterval(timerInterval);
            document.getElementById('remainTime').style.display='none';
            //display.text("00:00");
            $("#verification-error").show();
            $("#verification-error").text("ì¸ì¦ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
            
            // ë§Œë£Œëìœ¼ë¯€ë¡œ ì„¸ì…˜ì˜ ì¸ì¦ì½”ë“œ ë²ˆí˜¸ ì‚­ì œ 
            $.ajax({
                url : "",
                type : "POST"
            });
            
            //ë§Œë£Œëìœ¼ë¯€ë¡œ í™•ì¸ë²„íŠ¼ì˜ ì´ë²¤íŠ¸ë¦¬ìŠ¤ë„ˆ ì‚­ì œ
            document.getElementById('confirmBtn').removeEventListener('click', checkConfirmNumber);
        }
    }, 1000);
}

</script>
</head>
<body>
 <div class="header">
        <div class="header-content">
            <a th:href="@{/}"> <img th:src="@{/images/logo.png}" class="logo" style="width: 100px; height: 50px;"></a>
            <a th:href="@{/login}" class="login-link">ë¡œê·¸ì¸</a>
        </div>
    </div>

    <div class="container">
        <h1 class="form-title">ë¯¼ê¸°ì¸ë ¥ ê°œì¸íšŒì› ê°€ì…</h1>
        
        <form id="frm">
            <div class="form-group">
                <label class="form-label">ì•„ì´ë””</label>
                <input type="text" name="username" class="form-input" placeholder="4~20ì(ì˜ì–´/ìˆ«ì, 2ì ì´ìƒì€ë¬¸ì+ìˆ«ìì¡°í•©">
            </div>

            <div class="form-group">
                <label class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" name="password" class="form-input" placeholder="8~16ì(ì˜ë¬¸ ëŒ€ì†Œë¬¸ì/ìˆ«ì/íŠ¹ìˆ˜ë¬¸ì, 3ê°€ì§€ ì´ìƒì€í•„ìˆ˜ì¡°í•©)">
            </div>

            <div class="form-group">
            	<label class="form-label">íœ´ëŒ€í°</label>
            	<input type="text" name="phone" class="form-input" placeholder="'-'ë§Œ ë¹¼ê³  ìˆ«ìë§Œ ì…ë ¥">
            </div>

            <div class="form-group">
                <label class="form-label">ì´ë©”ì¼</label>
                <div class="email-container">
	                <input type="email" class="form-input" placeholder="name@mingihire.co.kr">
	                <button type="button" id="codeBtn" class="btn btn-primary btn-sm" >ì¸ì¦ìš”ì²­</button>
                </div>
                <div id="confirmNumberFrm" class="email-container" style="margin-top: 5px; display: none; gap: 8px;">
	                <input type="text" id="confirmNumber" class="form-input" placeholder="ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”." style="flex: 8;">
	                <button type="button" id="confirmBtn" class="btn btn-success btn-sm" style="flex: 2;" disabled>í™•ì¸</button> <!-- js: ìˆ«ì 6ìë¦¬ì¼ê²½ìš°ì—ë§Œ í™œì„±í™” -->
                </div>
                <div id="remainTime" style="display: none">
	                <span style="color: red; font-size: 12px;" >ë‚¨ì€ì‹œê°„: </span>
	                <span id="timer" style="margin-top: 5px; color: red; font-size: 12px;"></span>
                </div>
                <!-- <div id="timer" style="margin-top: 5px; color: red; font-weight: bold;"></div> -->
                <div id="verification-error" style="margin-top: 5px; color: red; font-weight: bold;"></div>
                <div id="verification-success" style="margin-top: 5px; color: green; font-weight: bold; display: none; font-size: 12px;">ì¸ì¦ì— ì„±ê³µí•˜ì…¨ìŠµë‹ˆë‹¤.</div>
            </div>

            <div class="form-group">
                <label class="form-label">ì´ë¦„</label>
                <input type="name" class="form-input" placeholder="ì´ë¦„ì…ë ¥">
            </div>

            <div class="form-group">
                <label class="form-label">ìƒë…„ì›”ì¼</label>
                <input type="birth" class="form-input" placeholder="YYYYMMDD">
            </div>

            <div class="form-group">
                <label class="form-label">ì•½ê´€</label>
                <div class="terms-section">
                    <div class="checkbox-group">
                        <div class="checkbox-item required-checkbox">
                            <input type="checkbox" class="checkbox-input" id="terms1">
                            <label for="terms1" class="checkbox-label"><strong>ì „ì²´ ë™ì˜</strong></label>
                        </div>
                        <div class="checkbox-item">
                       		<div class="terms-title">
                            <input type="checkbox" class="checkbox-input required" id="terms2">
                            <label for="terms2" class="checkbox-label"><strong>(í•„ìˆ˜) ê°œì¸íšŒì› ì•½ê´€ì— ë™ì˜</strong></label>
                       		</div>
                     			<div class="terms-detail-emoji">
                     				<a type="button" class="term-btn" data-term="userTerms" data-bs-toggle="modal" data-bs-target='#showTerm'> > </a>
                       		</div>
                        </div>
                        <div class="checkbox-item">
                        	<div class="terms-title">
                            <input type="checkbox" class="checkbox-input required" id="terms3">
                            <label for="terms3" class="checkbox-label"><strong>(í•„ìˆ˜) ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜</strong></label>
                          </div>
                          <div class="terms-detail-emoji">
                        		<a type="button" class="term-btn" data-term="privacyTerm" data-bs-toggle="modal" data-bs-target='#showTerm'> > </a>
                       		</div>
                        </div>
                        <div class="checkbox-item">
                          <div class="terms-title">  
                            <input type="checkbox" class="checkbox-input" id="terms4">
                            <label for="terms4" class="checkbox-label">(ì„ íƒ) ìœ„ì¹˜ê¸°ë°˜ì„œë¹„ìŠ¤ ì´ìš©ë™ì˜ì— ë™ì˜</label>
                          </div>
                          <div class="terms-detail-emoji">
                       			<a type="button" class="term-btn" data-term="locationTerm" data-bs-toggle="modal" data-bs-target='#showTerm'> > </a>
                       		</div> 
                        </div>
                        <div class="checkbox-item">
                          <div class="terms-title"> 
                            <input type="checkbox" class="checkbox-input" id="terms5">
                            <label for="terms5" class="checkbox-label">(ì„ íƒ) ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  ë™ì˜ Â· ì´ë©”ì¼</label>
                          </div>
                          <div class="terms-detail-emoji">
                        		<a type="button" class="term-btn" data-term="marketingTerm_email" data-bs-toggle="modal" data-bs-target='#showTerm'> > </a>
                       		</div>  
                        </div>
                        <div class="checkbox-item">
 													<div class="terms-title">
                            <input type="checkbox" class="checkbox-input" id="terms6">
                            <label for="terms6" class="checkbox-label">(ì„ íƒ) ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  ë™ì˜ Â· SMS/MMS</label>
                          </div>
                          <div class="terms-detail-emoji">
                        		<a type="button" class="term-btn" data-term="marketingTerm_sms" data-bs-toggle="modal" data-bs-target='#showTerm'> > </a>
                       		</div>  
                        </div>
                    </div>
                </div>
            </div>

            <button type="submit" id="submitBtn" class="submit-btn" >ë‹¤ìŒë‹¨ê³„</button>
        </form>
    </div>
    
    <!-- Vertically centered scrollable modal -->
    <div class="modal fade" id="showTerm" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			  <div class="modal-content">
			  
			  	<div class="modal-header">
			  		<h5 class="modal-title" id="myModalLabel">ì´ìš©ì•½ê´€</h5>
			  		<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
			  	</div>
			  	
	      	<div class="modal-body" id="modalBodyContent">
	      		<!-- th:replaceëŠ” "fragmentë¥¼ ì°¾ëŠ” ì—­í• , ê²½ë¡œëŠ” fragmentsì¼ í•„ìš”ì—†ìŒ, ê·¸ë¦¬ê³  í•´ë‹¹ íƒœê·¸ë¥¼ fragmentë‚´ìš©ìœ¼ë¡œ êµì²´í•˜ë©´ì„œ style="dislplay:none"ì´ ë¬´ì‹œë˜ê³  ì‚¬ë¼ì§ˆìˆ˜ìˆìŒ-->
	      		<!-- ë˜í•œ replaceëŠ” fragmentë¡œ ëŒ€ì²´ë˜ë©´ì„œ divì˜ id, class, style, data-* ì†ì„± ëª¨ë‘ ì‚¬ë¼ì§.. ë”°ë¼ì„œ insertë¥¼ ì“°ì  -->
						<div id="userTerms" class="term-fragment" style="display: none;" th:insert="~{login/terms/userTerms :: userTerms}"></div>
						<div id="privacyTerm" class="term-fragment" style="display: none;" th:insert="~{login/terms/privacyPolicyAgreement :: privacyTerm}"></div>
						<div id="locationTerm" class="term-fragment" style="display: none;" th:insert="~{login/terms/locationTerms :: locationTerm}"></div>
						<div id="marketingTerm_email" class="term-fragment" style="display: none;" th:insert="~{login/terms/marketingTerms_email :: marketingTerm_email}"></div>
						<div id="marketingTerm_sms" class="term-fragment" style="display: none;" th:insert="~{login/terms/marketingTerms_sms :: marketingTerm_sms}"></div>
		      </div>
			  </div>
			</div>
    </div>

</body>
</html>